{% extends '_inc/layout1.j2' %}

{% block head %}
<meta name="robots" content="index,follow">
<meta property="og:image" content="{{product.image}}">
<meta property="og:type" content="product">

<script type="application/ld+json">
  {{schema}}
</script>

<style>
  .arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    padding: 2px;
    cursor: pointer;
  }
</style>
{% endblock %}

{% block content %}
<!-- product + -->
<div class="container pb-2">
    <div class="breadcrumbs">
    </div>
    <div class="row vProduct mt-2">
      <div class="col-md-6 text-center vBgMaster">
        <div class="vProductImg">
          <button class="arrow" onclick="slideImage(-1)">←</button>
          <img class="img-fluid border mt-2" src="{{product.image}}" id="viMainImg" alt="{{product.name}}">
          <button class="arrow" onclick="slideImage(1)">→</button>
        </div>
        <div class="border-top mt-3 vProductThumbs_X">
        {% for xImage in product.images %}
          <img src="{{xImage}}" class="img-thumbnail" onclick="changeImage(this, 'viMainImg', true)" alt="{{product.name}}">
        {% endfor %}
        </div>
      </div>

      <div class="col-md-6 p-3 vBgSlave">
        <div class="d-flex justify-content-between p-2">
          <div>
            <a class="btn" id="vTo_favorite" title="{{lang.to_favorite}}" data-key="favorite"><i class="fa fa-heart"></i></a>
            <a class="btn" id="vTo_compare" title="{{lang.to_compare}}" data-key="compare"><i class="fa fa-balance-scale"></i></a>
          </div>
          <span>{{lang.code}}: {{info.url_id}}</span>
        </div>

        <h1>{{product.name}}</h1>
        <div class="pt-2 pb-2 product-attr-short">
          <h2>{{lang.available}}: {{product.stock}}</h2>
        </div>

        {%- if product.price_old -%}
        <p class="h3 text-danger price-old">{{product.price_old[0]}} {{product.price_old[1]}}</p>
          <p>
            <span class="h3 text-decoration-line-through">{{product.price[0]}} {{product.price[1]}}</span>
            {{ "%.1f" | format((product.price_old[0] / product.price[0] * 100) - 100) }}%
            </p>
        {%- else -%}
          <p class="h4">{{lang.price}}: {{product.price[0]}} {{product.price[1]}}</p>
        {%- endif %}

        {% if product.stock %}
          <button type="button" class="btn btn-primary mt-3 viAddToCart" data-product=''>
            <i class="fa fa-shopping-cart m-1"></i>{{lang.buy}}
          </button>
        {% else %}
          <button type="button" class="btn buyButtonOff mt-3" disabled>{{lang.not_available}}</button>
        {% endif%}
      </div>
    </div>

    <div class="row vBgMaster mt-1">
      <ul class="nav nav-tabs pt-3" id="productTabs" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="features-tab" data-bs-toggle="tab" href="#features" role="tab" aria-controls="features" aria-selected="true">{{lang.features}} ({{product.features | length}})</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="details-tab" data-bs-toggle="tab" href="#details" role="tab" aria-controls="details" aria-selected="false">{{lang.description}} ({{Iif(product.description, '+', '-')}})</a>
        </li>
      </ul>

      <div class="tab-content mt-1">
        <!--  tab_features + -->
        <div class="tab-pane fade show active m-3" id="features" role="tabpanel" aria-labelledby="features-tab">
          <div class="accordion">
          {%- for xKey, xVal in product.features.items() %}
            <div class="vItemOdd">{{xKey}}: {{xVal}}</div>
          {%- endfor %}
          </div>
        </div>
        <!--  tab_features - -->

        <!--  tab_descr + -->
        <div class="tab-pane fade" id="details" role="tabpanel" aria-labelledby="details-tab">
          {{Text2Html(product.description)}}
        </div>
        <!--  tab_descr - -->

      </div>
    </div>
  </div>

  <script>
    let curIdx = 0;
    const currentImage = document.getElementById("viMainImg");
    const images = document.getElementsByClassName("img-thumbnail")

    function slideImage(aStep) {
      curIdx += aStep;
        if (curIdx < 0) {
          curIdx = images.length - 1;
        } else if (curIdx >= images.length) {
          curIdx = 0;
        }
        currentImage.src = images[curIdx].src;
    }
  </script>
  <!-- product - -->
  {% endblock %}
